package test

import (
	"testing"

	"github.com/amirhnajafiz/explorer"
)

var (
	edgeData = []byte("{\n  \"schema\": {\n    \"type\": \"struct\",\n    \"fields\": [\n      {\n        \"type\": \"struct\",\n        \"fields\": [\n          {\n            \"type\": \"int64\",\n            \"optional\": false,\n            \"field\": \"id\"\n          },\n          {\n            \"type\": \"int64\",\n            \"optional\": false,\n            \"field\": \"ride_id\"\n          },\n          {\n            \"type\": \"int16\",\n            \"optional\": false,\n            \"field\": \"event_type\"\n          },\n          {\n            \"type\": \"string\",\n            \"optional\": true,\n            \"field\": \"additional_info\"\n          },\n          {\n            \"type\": \"string\",\n            \"optional\": false,\n            \"name\": \"io.debezium.time.ZonedTimestamp\",\n            \"version\": 1,\n            \"default\": \"1970-01-01T00:00:00Z\",\n            \"field\": \"created_at\"\n          },\n          {\n            \"type\": \"string\",\n            \"optional\": false,\n            \"name\": \"io.debezium.time.ZonedTimestamp\",\n            \"version\": 1,\n            \"default\": \"1970-01-01T00:00:00Z\",\n            \"field\": \"updated_at\"\n          }\n        ],\n        \"optional\": true,\n        \"name\": \"kafka.base_api.ride_events.Value\",\n        \"field\": \"before\"\n      },\n      {\n        \"type\": \"struct\",\n        \"fields\": [\n          {\n            \"type\": \"int64\",\n            \"optional\": false,\n            \"field\": \"id\"\n          },\n          {\n            \"type\": \"int64\",\n            \"optional\": false,\n            \"field\": \"ride_id\"\n          },\n          {\n            \"type\": \"int16\",\n            \"optional\": false,\n            \"field\": \"event_type\"\n          },\n          {\n            \"type\": \"string\",\n            \"optional\": true,\n            \"field\": \"additional_info\"\n          },\n          {\n            \"type\": \"string\",\n            \"optional\": false,\n            \"name\": \"io.debezium.time.ZonedTimestamp\",\n            \"version\": 1,\n            \"default\": \"1970-01-01T00:00:00Z\",\n            \"field\": \"created_at\"\n          },\n          {\n            \"type\": \"string\",\n            \"optional\": false,\n            \"name\": \"io.debezium.time.ZonedTimestamp\",\n            \"version\": 1,\n            \"default\": \"1970-01-01T00:00:00Z\",\n            \"field\": \"updated_at\"\n          }\n        ],\n        \"optional\": true,\n        \"name\": \"kafka.base_api.ride_events.Value\",\n        \"field\": \"after\"\n      },\n      {\n        \"type\": \"struct\",\n        \"fields\": [\n          {\n            \"type\": \"string\",\n            \"optional\": false,\n            \"field\": \"version\"\n          },\n          {\n            \"type\": \"string\",\n            \"optional\": false,\n            \"field\": \"connector\"\n          },\n          {\n            \"type\": \"string\",\n            \"optional\": false,\n            \"field\": \"name\"\n          },\n          {\n            \"type\": \"int64\",\n            \"optional\": false,\n            \"field\": \"ts_ms\"\n          },\n          {\n            \"type\": \"string\",\n            \"optional\": true,\n            \"name\": \"io.debezium.data.Enum\",\n            \"version\": 1,\n            \"parameters\": {\n              \"allowed\": \"true,last,false,incremental\"\n            },\n            \"default\": \"false\",\n            \"field\": \"snapshot\"\n          },\n          {\n            \"type\": \"string\",\n            \"optional\": false,\n            \"field\": \"db\"\n          },\n          {\n            \"type\": \"string\",\n            \"optional\": true,\n            \"field\": \"sequence\"\n          },\n          {\n            \"type\": \"string\",\n            \"optional\": true,\n            \"field\": \"table\"\n          },\n          {\n            \"type\": \"int64\",\n            \"optional\": false,\n            \"field\": \"server_id\"\n          },\n          {\n            \"type\": \"string\",\n            \"optional\": true,\n            \"field\": \"gtid\"\n          },\n          {\n            \"type\": \"string\",\n            \"optional\": false,\n            \"field\": \"file\"\n          },\n          {\n            \"type\": \"int64\",\n            \"optional\": false,\n            \"field\": \"pos\"\n          },\n          {\n            \"type\": \"int32\",\n            \"optional\": false,\n            \"field\": \"row\"\n          },\n          {\n            \"type\": \"int64\",\n            \"optional\": true,\n            \"field\": \"thread\"\n          },\n          {\n            \"type\": \"string\",\n            \"optional\": true,\n            \"field\": \"query\"\n          }\n        ],\n        \"optional\": false,\n        \"name\": \"io.debezium.connector.mysql.Source\",\n        \"field\": \"source\"\n      },\n      {\n        \"type\": \"string\",\n        \"optional\": false,\n        \"field\": \"op\"\n      },\n      {\n        \"type\": \"int64\",\n        \"optional\": true,\n        \"field\": \"ts_ms\"\n      },\n      {\n        \"type\": \"struct\",\n        \"fields\": [\n          {\n            \"type\": \"string\",\n            \"optional\": false,\n            \"field\": \"id\"\n          },\n          {\n            \"type\": \"int64\",\n            \"optional\": false,\n            \"field\": \"total_order\"\n          },\n          {\n            \"type\": \"int64\",\n            \"optional\": false,\n            \"field\": \"data_collection_order\"\n          }\n        ],\n        \"optional\": true,\n        \"field\": \"transaction\"\n      }\n    ],\n    \"optional\": false,\n    \"name\": \"kafka.base_api.ride_events.Envelope\"\n  },\n  \"payload\": {\n    \"before\": null,\n    \"after\": {\n      \"id\": 9995446092,\n      \"ride_id\": 2351775838,\n      \"event_type\": 4,\n      \"additional_info\": null,\n      \"created_at\": \"2020-12-31T20:30:00Z\",\n      \"updated_at\": \"2020-12-31T20:30:00Z\"\n    },\n    \"source\": {\n      \"version\": \"1.9.7.Final\",\n      \"connector\": \"mysql\",\n      \"name\": \"kafka\",\n      \"ts_ms\": 1673074381000,\n      \"snapshot\": \"true\",\n      \"db\": \"base-api\",\n      \"sequence\": null,\n      \"table\": \"ride_events\",\n      \"server_id\": 0,\n      \"gtid\": null,\n      \"file\": \"mariadb-bin.012127\",\n      \"pos\": 56288596,\n      \"row\": 0,\n      \"thread\": null,\n      \"query\": null\n    },\n    \"op\": \"r\",\n    \"ts_ms\": 1673074381817,\n    \"transaction\": null\n  }\n}")
)

// TestEdgeBug will test a big json object.
func TestEdgeBug(t *testing.T) {
	_, err := explorer.ParseJsonObject(edgeData)
	if err != nil {
		t.Error(err)
	}
}
